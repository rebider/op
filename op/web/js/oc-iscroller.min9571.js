var IScroller=function(t){"use strict";var e,i,o,n,r,a,s,l,c,d={},h={},u={},f=1,p=function(e){h.navSelector=e.paginatorSelector,h.nextSelector=e.paginatorSelector+" a:first",h.itemSelector=e.itemSelector,h.loading=h.loading||{},h.loading.msgText=e.loadingMsg,h.loading.finishedMsg=e.finishMsg,h.loading.speed=0,h.loading.img="catalog/view/theme/default/image/oc-iscroller-loader.gif",h.state=h.state||{},h.state.currPage=e.curPage,t(".journal-sf").size()&&(h.loading.start=O),h.bufferPx=2e3,h.debug="1"===e.debugMode,h.animate="1"===e.animation},g=function(){o=t(d.containerSelector),n=t(d.paginatorSelector),o.infinitescroll(h,b),(e=o.data("infinitescroll"))&&(e._nearbottom_ociscr=w,e._showdonemsg_ociscr=x,("button"===d.loadingMode||"smart"===d.loadingMode&&d.show_btn_after<=e.options.state.currPage)&&(o.infinitescroll("pause"),_())),n.hide(),y()},v=function(){t("body").disconnect(),e&&(e.destroy(),t(d.containerSelector).data("infinitescroll",null)),i&&i.remove(),n&&n.show(),t(".iscroller-separator").remove()},b=function(e,i){t("body").disconnect(),m(e),y()},m=function(e){l||(l=t("<div />").copyEvents(t(d.itemSelector).first())),t.each(e,function(i,o){t(o).copyEvents(l);var n=t(e[i]).attr("data-id");if(t(o).after('<div class="similar-pro'+n+'"></div>'),f/4==1){var r=t(e[i-2]).attr("data-id");t(o).after('<div class="similar-products'+r+'"></div>'),f=1}else f++})},_=function(){var e=t("<div />",{class:"iscroller-btn-cont"});(i=t("<a />",{class:"iscroller-btn btn btn-default"})).text(d.buttonLabel).on("click",function(){o.infinitescroll("retrieve")}),o.after(e.append(i))},y=function(){t("body").observe("childList",d.paginatorSelector,function(){v(),g()}),t("body").observe({attributes:!0,attributeFilter:["href"]},d.paginatorSelector+" a",function(){v(),g()})},w=function(){var e=t(d.itemSelector).last();return t(window).scrollTop()+t(window).height()+this.options.bufferPx>e.offset().top+e.height()},x=function(){var e=this.options;e.loading.msg.find("img").animate({opacity:0},500).parent().find("i").html(e.loading.finishedMsg),e.loading.msg.delay(1e3).animate({opacity:0},1e3,function(){t(this).slideUp(500,function(){t(this).css({opacity:1})})}),e.errorCallback.call(t(e.contentSelector)[0],"done"),c=e.state.currPage-1},S=function(){var i=e.options;i.state.isBeyondMaxPage||i.loading.msg.animate({opacity:0},100,function(){t(this).slideUp(200,function(){t(this).css({opacity:1})})})},N=function(){a=t("<div />",{class:"iscroller-bar"}),s=t("<div />",{class:"iscroller-arrow"}),a.css({display:"none"}),a.addClass("left"===u.position?"iscroller-left":"iscroller-right"),s.css({}),s.append("<div/>"),s.find("div").css({}),t("body").append(a.append(s)),j(),a.on("click",T),t(document).on("scroll",P),t(window).on("resize",j)},T=function(){var e=!a.hasClass("iscroller-top"),i=e?"bottom":"top",o=e?t(window).scrollTop():r,n=e?0:o,l={},c={},d={};r=o,e&&!o||(l[i]=parseInt(s.css(i))+50,l.opacity=0,c[i]="",c.opacity=1,a.data("auto",!1),a.data("toTop",e),a.data("scrollTo",n),t("html, body").stop().animate({scrollTop:n},~~u.speed,function(){a.removeClass("iscroller-auto")}),s.stop().animate(l,300,function(){a.toggleClass("iscroller-top",e),s.delay(300).css(c).stop().fadeIn(300).find("div").css(d)}))},P=function(){var e=t(window).scrollTop(),i=a.data("auto"),o=a.data("scrollTo");i||(e?a.is(":visible")||a.stop().fadeIn(300):a.is(":visible")&&a.stop().fadeOut(300),a.removeClass("iscroller-top"),s.find("div").css({})),i&&e===o&&a.data("auto",!1)},j=function(){var e=t(window).width();if(a.toggleClass("iscroller-hidden",e<=~~u.minWidthToShow),a.toggleClass("iscroller-as-btn",e<=~~u.minWidthToShowAsBar),u.fitTo){var i=t(u.fitTo).first();if(i.size())if("left"===u.position){var o=i.offset().left;a.css({left:o,right:"auto"})}else{var n=t(document).width()-i.offset().left-i.outerWidth();a.css({left:"auto",right:n})}}},k=function(){if(void 0!==window.history.pushState){var i,n=~~t(document).scrollTop(),r=c||e.options.state.currPage,a=o.offset().top,s=o.height(),l=t(window).height(),d=Math.ceil((n-a+l)/(s/r)),h=window.location.search.replace(/\&?(xpage|xoffset)\=[\d]+/g,"");d=d<1?1:d>r?r:d,h=""===h?"?":"?"===h?h:h+"&",h+="xpage="+d+"&xoffset="+n,i=window.location.protocol+"//"+window.location.hostname+window.location.pathname+h+window.location.hash,window.history.replaceState(null,null,i)}},O=function(){var i=e.options,o=e;t(i.navSelector).hide(),i.loading.msg.appendTo(i.loading.selector).show(i.loading.speed,t.proxy(function(){i.state.currPage++;var e=[];if(""===window.location.hash.substring(1)){if(t(".sort").length>0){var n=t(".sort select option:selected").val().split("sort=")[1].split("&");e.push("sort="+n[0]),e.push("order="+n[1].replace("order=",""))}t(".limit").length>0&&e.push("limit="+t(".limit select option:selected").text())}i.state.currPage&&e.push("page="+i.state.currPage);var r=t(".journal-sf"),a=window.location.hash.substring(1)+"/"+e.join("/"),s={filters:a,route:r.attr("data-route"),path:r.attr("data-path"),manufacturer_id:r.attr("data-manufacturer"),search:r.attr("data-search"),tag:r.attr("data-tag")};console.log(r.attr("data-products-action")),t.ajax({url:r.attr("data-products-action"),type:"post",data:s,success:function(e){console.log(e);var n=t(i.contentSelector).is("table, tbody")?t("<tbody/>"):t("<div/>"),r=t("<div/>").append(e).find(i.itemSelector);n.append(r),o._loadcallback(n,e,a)}})},self))};return{init:function(e){d=e.infScroll,u=e.scrollTop,~~e.infScroll.enabled&&(p(e.infScroll),h.behavior="ociscr",h.loading.finished=S,"auto"!==d.loadingMode&&(h.errorCallback=function(){i&&i.hide()}),g(),~~e.infScroll.statefulScroll&&setTimeout(function(){t(document).on("scroll",k)},1)),~~e.scrollTop.enabled&&N(),~~e.infScroll.offsetTop&&t(window).scrollTop(~~e.infScroll.offsetTop)}}}(jQuery);window.IScroller=IScroller,jQuery.Observe={},function(t,e){var i=function(e,i){i||(i=e,e=window.document);var o=[];return t(i).each(function(){for(var i=[],n=t(this),r=n.parent();r.length&&!n.is(e);r=r.parent()){var a=n.get(0).tagName.toLowerCase();i.push(a+":eq("+r.children(a).index(n)+")"),n=r}(r.length||n.is(e))&&o.push("> "+i.reverse().join(" > "))}),o.join(", ")};jQuery.Observe.path={get:i,capture:function(e,o){o||(o=e,e=window.document);var n=[];return t(o).each(function(){var o=-1,r=this;if(this instanceof Text){r=this.parentNode;for(var a=r?r.childNodes:[],s=0;s<a.length;s++)if(a[s]===this){o=s;break}}var l=i(e,r),c=t(e).is(r);n.push(function(e){return e=c?e:t(e).find(l),-1===o?e:e.contents()[o]})}),function(e){return e=e||window.document,n.reduce(function(t,i){return t.add(i(e))},t([]))}}}}(jQuery),function(t,e){var i=function(e){this.original=t(e),this.root=this.original.clone(!1,!0)};i.prototype.find=function(t){return e.path.capture(this.original,t)(this.root)},e.Branch=i}(jQuery,jQuery.Observe),function(t,e){var i=function(t,e){var i={};return t.forEach(function(t){(t=e(t))&&(i[t[0]]=t[1])}),i},o=i("childList attributes characterData subtree attributeOldValue characterDataOldValue attributeFilter".split(" "),function(t){return[t.toLowerCase(),t]}),n=i(Object.keys(o),function(t){if("attributefilter"!==t)return[o[t],!0]}),r=i(["added","removed"],function(t){return[t.toLowerCase(),t]}),a=t([]),s=function(t){if("object"==typeof t)return t;var e={};return(t=t.split(/\s+/)).forEach(function(t){if(t=t.toLowerCase(),!o[t]&&!r[t])throw Error("Unknown option "+t);e[o[t]||r[t]]=!0}),e},l=function(t){return"["+Object.keys(t).sort().reduce(function(e,i){var o=t[i]&&"object"==typeof t[i]?l(t[i]):t[i];return e+"["+JSON.stringify(i)+":"+o+"]"},"")+"]"},c=window.MutationObserver||window.WebKitMutationObserver,d=function(e,i,o,n){this._originalOptions=t.extend({},i),i=t.extend({},i),this.attributeFilter=i.attributeFilter,delete i.attributeFilter,o&&(i.subtree=!0),i.childList&&(i.added=!0,i.removed=!0),(i.added||i.removed)&&(i.childList=!0),this.target=t(e),this.options=i,this.selector=o,this.handler=n};d.prototype.is=function(t,e,i){return l(this._originalOptions)===l(t)&&this.selector===e&&this.handler===i},d.prototype.match=function(e){var i=this.options,o=e.type;if(!this.options[o])return a;if(this.selector)switch(o){case"attributes":if(!this._matchAttributeFilter(e))break;case"characterData":return this._matchAttributesAndCharacterData(e);case"childList":if(e.addedNodes&&e.addedNodes.length&&i.added&&(o=this._matchAddedNodes(e)).length)return o;if(e.removedNodes&&e.removedNodes.length&&i.removed)return this._matchRemovedNodes(e)}else{var n=e.target instanceof Text?t(e.target).parent():t(e.target);if(!i.subtree&&n.get(0)!==this.target.get(0))return a;switch(o){case"attributes":if(!this._matchAttributeFilter(e))break;case"characterData":return this.target;case"childList":if(e.addedNodes&&e.addedNodes.length&&i.added||e.removedNodes&&e.removedNodes.length&&i.removed)return this.target}}return a},d.prototype._matchAttributesAndCharacterData=function(t){return this._matchSelector(this.target,[t.target])},d.prototype._matchAddedNodes=function(t){return this._matchSelector(this.target,t.addedNodes)},d.prototype._matchRemovedNodes=function(i){var o=new e.Branch(this.target),n=Array.prototype.slice.call(i.removedNodes).map(function(t){return t.cloneNode(!0)});return i.previousSibling?o.find(i.previousSibling).after(n):i.nextSibling?o.find(i.nextSibling).before(n):(this.target===i.target?o.root:o.find(i.target)).empty().append(n),this._matchSelector(o.root,n).length?t(i.target):a},d.prototype._matchSelector=function(e,i){var o=e.find(this.selector);return i=Array.prototype.slice.call(i),o.filter(function(){var e=this;return i.some(function(i){return i instanceof Text?i.parentNode===e:i===e||t(i).has(e).length})})},d.prototype._matchAttributeFilter=function(t){return!this.attributeFilter||!this.attributeFilter.length||0<=this.attributeFilter.indexOf(t.attributeName)};var h=function(t){this.patterns=[],this._target=t,this._observer=null};h.prototype.observe=function(t,e,i){var o=this;this._observer?this._observer.disconnect():this._observer=new c(function(t){t.forEach(function(t){o.patterns.forEach(function(e){var i=e.match(t);i.length&&i.each(function(){e.handler.call(this,t)})})})}),this.patterns.push(new d(this._target,t,e,i)),this._observer.observe(this._target,this._collapseOptions())},h.prototype.disconnect=function(t,e,i){var o=this;this._observer&&(this.patterns.filter(function(o){return o.is(t,e,i)}).forEach(function(t){t=o.patterns.indexOf(t),o.patterns.splice(t,1)}),this.patterns.length||this._observer.disconnect())},h.prototype.disconnectAll=function(){this._observer&&(this.patterns=[],this._observer.disconnect())},h.prototype.pause=function(){this._observer&&this._observer.disconnect()},h.prototype.resume=function(){this._observer&&this._observer.observe(this._target,this._collapseOptions())},h.prototype._collapseOptions=function(){var e={};return this.patterns.forEach(function(i){var o=e.attributes&&e.attributeFilter;if(!o&&e.attributes||!i.attributeFilter)o&&i.options.attributes&&!i.attributeFilter&&delete e.attributeFilter;else{var n={},r=[];(e.attributeFilter||[]).concat(i.attributeFilter).forEach(function(t){n[t]||(r.push(t),n[t]=1)}),e.attributeFilter=r}t.extend(e,i.options)}),Object.keys(r).forEach(function(t){delete e[r[t]]}),e};var u=function(t){this.patterns=[],this._paused=!1,this._target=t,this._events={},this._handler=this._handler.bind(this)};u.prototype.NS=".jQueryObserve",u.prototype.observe=function(e,i,o){e=new d(this._target,e,i,o),t(this._target),e.options.childList&&(this._addEvent("DOMNodeInserted"),this._addEvent("DOMNodeRemoved")),e.options.attributes&&this._addEvent("DOMAttrModified"),e.options.characterData&&this._addEvent("DOMCharacerDataModified"),this.patterns.push(e)},u.prototype.disconnect=function(e,i,o){var n=t(this._target),r=this;this.patterns.filter(function(t){return t.is(e,i,o)}).forEach(function(t){t=r.patterns.indexOf(t),r.patterns.splice(t,1)});var a=this.patterns.reduce(function(t,e){return e.options.childList&&(t.DOMNodeInserted=!0,t.DOMNodeRemoved=!0),e.options.attributes&&(t.DOMAttrModified=!0),e.options.characterData&&(t.DOMCharacerDataModified=!0),t},{});Object.keys(this._events).forEach(function(t){a[t]||(delete r._events[t],n.off(t+r.NS,r._handler))})},u.prototype.disconnectAll=function(){var e,i=t(this._target);for(e in this._events)i.off(e+this.NS,this._handler);this._events={},this.patterns=[]},u.prototype.pause=function(){this._paused=!0},u.prototype.resume=function(){this._paused=!1},u.prototype._handler=function(e){if(!this._paused){var i={type:null,target:null,addedNodes:null,removedNodes:null,previousSibling:null,nextSibling:null,attributeName:null,attributeNamespace:null,oldValue:null};switch(e.type){case"DOMAttrModified":i.type="attributes",i.target=e.target,i.attributeName=e.attrName,i.oldValue=e.prevValue;break;case"DOMCharacerDataModified":i.type="characterData",i.target=t(e.target).parent().get(0),i.attributeName=e.attrName,i.oldValue=e.prevValue;break;case"DOMNodeInserted":i.type="childList",i.target=e.relatedNode,i.addedNodes=[e.target],i.removedNodes=[];break;case"DOMNodeRemoved":i.type="childList",i.target=e.relatedNode,i.addedNodes=[],i.removedNodes=[e.target]}for(e=0;e<this.patterns.length;e++){var o=this.patterns[e],n=o.match(i);n.length&&n.each(function(){o.handler.call(this,i)})}}},u.prototype._addEvent=function(e){this._events[e]||(t(this._target).on(e+this.NS,this._handler),this._events[e]=!0)},e.Pattern=d,e.MutationObserver=h,e.DOMEventObserver=u,t.fn.observe=function(e,i,o){return i?o||(o=i,i=null):(o=e,e=n),this.each(function(){var n=t(this),r=n.data("observer");r||(r=c?new h(this):new u(this),n.data("observer",r)),e=s(e),r.observe(e,i,o)})},t.fn.disconnect=function(e,i,o){return e&&(i?o||(o=i,i=null):(o=e,e=n)),this.each(function(){var n=t(this),r=n.data("observer");r&&(e?(e=s(e),r.disconnect(e,i,o)):(r.disconnectAll(),n.removeData("observer")))})}}(jQuery,jQuery.Observe),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){t.fn.extend({copyEvents:function(e){return t.event.copy(t(e),this),this},copyEventsTo:function(e){return t.event.copy(this,t(e)),this}}),t.event.copy=function(e,i){var o=e[0],n=o&&(t._data&&t._data(o,"events")||t.data&&t.data(o,"events")||o.$events||o.events)||{};i.each(function(){var e,i=this;for(e in n)t.each(n[e],function(o,n){var r=(r=void 0!==n.namespace&&n.namespace||n.type||"").length?(0===r.indexOf(".")?"":".")+r:"";t.event.add(i,e+r,n.handler||n,n.data)})})}}),function(t,e,i){"use strict";e.infinitescroll=function(t,i,o){this.element=e(o),this._create(t,i)||(this.failed=!0)},e.infinitescroll.defaults={loading:{finished:i,finishedMsg:"<em>Congratulations, you've reached the end of the internet.</em>",img:"",msg:null,msgText:"<em>Loading the next set of posts...</em>",selector:null,speed:"fast",start:i},state:{isDuringAjax:!1,isInvalidPage:!1,isDestroyed:!1,isDone:!1,isPaused:!1,isBeyondMaxPage:!1,currPage:1},debug:!1,behavior:i,binder:e(t),nextSelector:"div.navigation a:first",navSelector:"div.navigation",contentSelector:null,extraScrollPx:150,itemSelector:"div.post",animate:!1,pathParse:i,dataType:"html",appendCallback:!0,bufferPx:1e3,errorCallback:function(){},infid:0,pixelsFromNavToBottom:i,path:i,prefill:!1,maxPage:i},e.infinitescroll.prototype={_binding:function(t){var e=this,o=e.options;if(o.v="2.0b2.120520",o.behavior&&this["_binding_"+o.behavior]!==i)this["_binding_"+o.behavior].call(this);else{if("bind"!==t&&"unbind"!==t)return this._debug("Binding value  "+t+" not valid"),!1;"unbind"===t?this.options.binder.unbind("smartscroll.infscr."+e.options.infid):this.options.binder[t]("smartscroll.infscr."+e.options.infid,function(){e.scroll()}),this._debug("Binding",t)}},_create:function(o,n){var r=e.extend(!0,{},e.infinitescroll.defaults,o);this.options=r;var a=e(t);if(!this._validate(o))return!1;var s=e(r.nextSelector).attr("href");if(!s)return this._debug("Navigation selector not found"),!1;r.path=r.path||this._determinepath(s),r.contentSelector=r.contentSelector||this.element,r.loading.selector=r.loading.selector||r.contentSelector,r.loading.msg=r.loading.msg||e('<div id="infscr-loading"><div>'+r.loading.msgText+"</div></div>"),(new Image).src=r.loading.img,r.pixelsFromNavToBottom===i&&(r.pixelsFromNavToBottom=e(document).height()-e(r.navSelector).offset().top,this._debug("pixelsFromNavToBottom: "+r.pixelsFromNavToBottom));var l=this;return r.loading.start=r.loading.start||function(){e(r.navSelector).hide(),r.loading.msg.appendTo(r.loading.selector).show(r.loading.speed,e.proxy(function(){this.beginAjax(r)},l))},r.loading.finished=r.loading.finished||function(){r.state.isBeyondMaxPage||r.loading.msg.fadeOut(r.loading.speed)},r.callback=function(t,o,s){r.behavior&&t["_callback_"+r.behavior]!==i&&t["_callback_"+r.behavior].call(e(r.contentSelector)[0],o,s),n&&n.call(e(r.contentSelector)[0],o,r,s),r.prefill&&a.bind("resize.infinite-scroll",t._prefill)},o.debug&&(!Function.prototype.bind||"object"!=typeof console&&"function"!=typeof console||"object"!=typeof console.log||["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(t){console[t]=this.call(console[t],console)},Function.prototype.bind)),this._setup(),r.prefill&&this._prefill(),!0},_prefill:function(){function i(){return o.options.contentSelector.height()<=n.height()}var o=this,n=e(t);this._prefill=function(){i()&&o.scroll(),n.bind("resize.infinite-scroll",function(){i()&&(n.unbind("resize.infinite-scroll"),o.scroll())})},this._prefill()},_debug:function(){!0===this.options.debug&&("undefined"!=typeof console&&"function"==typeof console.log?1===Array.prototype.slice.call(arguments).length&&"string"==typeof Array.prototype.slice.call(arguments)[0]?console.log(Array.prototype.slice.call(arguments).toString()):console.log(Array.prototype.slice.call(arguments)):Function.prototype.bind||"undefined"==typeof console||"object"!=typeof console.log||Function.prototype.call.call(console.log,console,Array.prototype.slice.call(arguments)))},_determinepath:function(t){var e=this.options;if(e.behavior&&this["_determinepath_"+e.behavior]!==i)return this["_determinepath_"+e.behavior].call(this,t);if(e.pathParse)return this._debug("pathParse manual"),e.pathParse(t,this.options.state.currPage+1);if(t.match(/^(.*?)\b2\b(.*?$)/))t=t.match(/^(.*?)\b2\b(.*?$)/).slice(1);else if(t.match(/^(.*?)2(.*?$)/)){if(t.match(/^(.*?page=)2(\/.*|$)/))return t=t.match(/^(.*?page=)2(\/.*|$)/).slice(1);t=t.match(/^(.*?)2(.*?$)/).slice(1)}else{if(t.match(/^(.*?page=)1(\/.*|$)/))return t=t.match(/^(.*?page=)1(\/.*|$)/).slice(1);this._debug("Sorry, we couldn't parse your Next (Previous Posts) URL. Verify your the css selector points to the correct A tag. If you still get this error: yell, scream, and kindly ask for help at infinite-scroll.com."),e.state.isInvalidPage=!0}return this._debug("determinePath",t),t},_error:function(t){var e=this.options;e.behavior&&this["_error_"+e.behavior]!==i?this["_error_"+e.behavior].call(this,t):("destroy"!==t&&"end"!==t&&(t="unknown"),this._debug("Error",t),("end"===t||e.state.isBeyondMaxPage)&&this._showdonemsg(),e.state.isDone=!0,e.state.currPage=1,e.state.isPaused=!1,e.state.isBeyondMaxPage=!1,this._binding("unbind"))},_loadcallback:function(o,n,r){var a,s=this.options,l=this.options.callback,c=s.state.isDone?"done":s.appendCallback?"append":"no-append";if(s.behavior&&this["_loadcallback_"+s.behavior]!==i)this["_loadcallback_"+s.behavior].call(this,o,n);else{switch(c){case"done":return this._showdonemsg(),!1;case"no-append":"html"===s.dataType&&(n=e(n="<div>"+n+"</div>").find(s.itemSelector));break;case"append":var d=o.children();if(0===d.length)return this._error("end");for(a=document.createDocumentFragment();o[0].firstChild;)a.appendChild(o[0].firstChild);this._debug("contentSelector",e(s.contentSelector)[0]),e(s.contentSelector)[0].appendChild(a),n=d.get()}if(s.loading.finished.call(e(s.contentSelector)[0],s),s.animate){var h=e(t).scrollTop()+e(s.loading.msg).height()+s.extraScrollPx+"px";e("html,body").animate({scrollTop:h},100,function(){s.state.isDuringAjax=!1})}s.animate||(s.state.isDuringAjax=!1),l(this,n,r),s.prefill&&this._prefill()}},_nearbottom:function(){var o=this.options,n=0+e(document).height()-o.binder.scrollTop()-e(t).height();return o.behavior&&this["_nearbottom_"+o.behavior]!==i?this["_nearbottom_"+o.behavior].call(this):(this._debug("math:",n,o.pixelsFromNavToBottom),n-o.bufferPx<o.pixelsFromNavToBottom)},_pausing:function(t){var e=this.options;if(!e.behavior||this["_pausing_"+e.behavior]===i){switch("pause"!==t&&"resume"!==t&&null!==t&&this._debug("Invalid argument. Toggling pause value instead"),t=!t||"pause"!==t&&"resume"!==t?"toggle":t){case"pause":e.state.isPaused=!0;break;case"resume":e.state.isPaused=!1;break;case"toggle":e.state.isPaused=!e.state.isPaused}return this._debug("Paused",e.state.isPaused),!1}this["_pausing_"+e.behavior].call(this,t)},_setup:function(){var t=this.options;if(!t.behavior||this["_setup_"+t.behavior]===i)return this._binding("bind"),!1;this["_setup_"+t.behavior].call(this)},_showdonemsg:function(){var t=this.options;t.behavior&&this["_showdonemsg_"+t.behavior]!==i?this["_showdonemsg_"+t.behavior].call(this):(t.loading.msg.find("img").hide().parent().find("div").html(t.loading.finishedMsg).animate({opacity:1},2e3,function(){e(this).parent().fadeOut(t.loading.speed)}),t.errorCallback.call(e(t.contentSelector)[0],"done"))},_validate:function(t){for(var i in t)if(i.indexOf&&i.indexOf("Selector")>-1&&0===e(t[i]).length)return this._debug("Your "+i+" found no elements."),!1;return!0},bind:function(){this._binding("bind")},destroy:function(){return this.options.state.isDestroyed=!0,this.options.loading.finished(),this._error("destroy")},pause:function(){this._pausing("pause")},resume:function(){this._pausing("resume")},beginAjax:function(t){var o,n,r,a,s=this,l=t.path;if(t.state.currPage++,t.maxPage!=i&&t.state.currPage>t.maxPage)return t.state.isBeyondMaxPage=!0,void this.destroy();o=e(t.contentSelector).is("table, tbody")?e("<tbody/>"):e("<div/>");var c="raw="+(n="function"==typeof l?l(t.state.currPage):l.join(t.state.currPage)).replace(/^.*\/\/[^\/]+/,"");switch(n="/showmoreproducts&"+c,s._debug("heading into ajax",n),r="html"===t.dataType||"json"===t.dataType?t.dataType:"html+callback",t.appendCallback&&"html"===t.dataType&&(r+="+callback"),r){case"html+callback":s._debug("Using HTML via .load() method"),o.load(n+" "+t.itemSelector,i,function(t){s._loadcallback(o,t,n)});break;case"html":s._debug("Using "+r.toUpperCase()+" via $.ajax() method"),e.ajax({url:n,dataType:t.dataType,complete:function(t,e){console.log(t),console.log("fg"),(a=void 0!==t.isResolved?t.isResolved():"success"===e||"notmodified"===e)?s._loadcallback(o,t.responseText,n):s._error("end")}});break;case"json":s._debug("Using "+r.toUpperCase()+" via $.ajax() method"),e.ajax({dataType:"json",type:"GET",url:n,success:function(e,r,l){if(a=void 0!==l.isResolved?l.isResolved():"success"===r||"notmodified"===r,t.appendCallback)if(t.template!==i){var c=t.template(e);o.append(c),a?s._loadcallback(o,c):s._error("end")}else s._debug("template must be defined."),s._error("end");else a?s._loadcallback(o,e,n):s._error("end")},error:function(){s._debug("JSON ajax request failed."),s._error("end")}})}},retrieve:function(t){t=t||null;var o=this.options;if(o.behavior&&this["retrieve_"+o.behavior]!==i)this["retrieve_"+o.behavior].call(this,t);else{if(o.state.isDestroyed)return this._debug("Instance is destroyed"),!1;o.state.isDuringAjax=!0,o.loading.start.call(e(o.contentSelector)[0],o)}},scroll:function(){var t=this.options,e=t.state;t.behavior&&this["scroll_"+t.behavior]!==i?this["scroll_"+t.behavior].call(this):e.isDuringAjax||e.isInvalidPage||e.isDone||e.isDestroyed||e.isPaused||this._nearbottom()&&this.retrieve()},toggle:function(){this._pausing()},unbind:function(){this._binding("unbind")},update:function(t){e.isPlainObject(t)&&(this.options=e.extend(!0,this.options,t))}},e.fn.infinitescroll=function(t,i){switch(typeof t){case"string":var o=Array.prototype.slice.call(arguments,1);this.each(function(){var i=e.data(this,"infinitescroll");return!!i&&(!(!e.isFunction(i[t])||"_"===t.charAt(0))&&void i[t].apply(i,o))});break;case"object":this.each(function(){var o=e.data(this,"infinitescroll");o?o.update(t):(o=new e.infinitescroll(t,i,this)).failed||e.data(this,"infinitescroll",o)})}return this};var o,n=e.event;n.special.smartscroll={setup:function(){e(this).bind("scroll",n.special.smartscroll.handler)},teardown:function(){e(this).unbind("scroll",n.special.smartscroll.handler)},handler:function(t,i){var n=this,r=arguments;t.type="smartscroll",o&&clearTimeout(o),o=setTimeout(function(){e(n).trigger("smartscroll",r)},"execAsap"===i?0:100)}},e.fn.smartscroll=function(t){return t?this.bind("smartscroll",t):this.trigger("smartscroll",["execAsap"])}}(window,jQuery);